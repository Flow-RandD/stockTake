<!DOCTYPE html>
<html>
  <head>
  <link rel="manifest" href="manifest.json">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="application-name" content="calUP">
  <meta name="apple-mobile-web-app-title" content="sorUP">
  <meta name="theme-color" content="#b3ffff">
  <meta name="msapplication-navbutton-color" content="#ffff00">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="msapplication-starturl" content="https://flow-randd.github.io/calendarUpdate/">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    
    <style> 
      h5 {
        color: grey;
        margin-top: 0px
      }
      html, body {
        background: #FFFFFF;
        padding: 0px;
        height: 100%;
        width: 99%;
        margin: auto;
        overflow:auto;
        position: relative;
        background: #FFFFFF; /* For browsers that do not support gradients */
        background: -webkit-linear-gradient(rgba(179,255,255,1), white);
        background: -moz-linear-gradient(rgba(179,255,255,1), white);
        background: -o-linear-gradient(rgba(179,255,255,1), white);
        background: linear-gradient(rgba(179,255,255,1), white 70%);
      }
      #div1 {  
        border-radius: 25px;
        padding: 10px;
        height: auto;
        width: auto;
        margin: auto;
        overflow: auto;
      }
      input[type=text]:focus {
        background-color: lightblue;
      }
      img {
        display: block;
        margin: auto;
        width: 80%
      }
    </style>
    <img src="https://flow-randd.github.io/calendarUpdate/images/Flowstore_Logo_CUT OUT_v1.png" alt="FLOWSTORE SYSTEMS LTD.">
  </head>

  <body>
  <!--bodyInner-->  
  <header><marquee><h3>Stock Take</h3></marquee></header>
    <div id="div1">
    <h5>Please complete the form</h5>
      <form name="formA">
          <label id="locationLB">Location:</label><br>
          <input type="text" id="location" name="location" style="width:50%"><br><br>
          <label id="ptNumLB">GS-ACE Part Number:</label><br>
          <input type="text" id="ptNum" name="ptNum" style="width:50%" onchange="validatorGS()"><br><br>
          <label id="stockCdLB">Flowstore Stock Code:</label><br>
          <input type="text" id="stockCd" name="stockCd" style="width:50%" onchange="validatorFS()"><br><br>
          <label id="unitOfMeasureLB">Unit of Measure:</label><br>
          <input type="radio" id="unitOfMeasure" name="unitOfMeasure" value="metre">Metre<br>
          <input type="radio" id="unitOfMeasure" name="unitOfMeasure" value="each">Each<br><br>
          <label id="qtyLB">Quantity:</label><br>
          <input type="number" id="qty" name="qty" style="width:50%"><br><br>
          <label id="notesLB">Notes:</label><br>
          <input type="text" id="notes" name="notes" style="width:50%"><br><br>
      </form>
           
      <div id="clickers">  
        <!-- Post -->
        <button class="action" type="submit" id="submit-form" onclick="postToAppsScript()">Submit</button>
        <!-- Clear -->
        <button class="Close" onclick="uncheckAll()">Clear</button><p><br><p>
      
        <!--Add buttons to initiate auth sequence and sign out-->
        <button id="authorize-button" style="display: none;">Authorise</button><p>
        <button id="signout-button" style="display: none;">Sign Out</button>
      </div>
    </div>
      
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
      
    <script>
      var radios = document.formA.unitOfMeasure;
        for(var i = 0, max = radios.length; i < max; i++) {
          radios[i].onclick = function() {
            if (this.value=="metre"){
              result = prompt("How many metres is this item:","3");
            }else {
              result = "";
            }
          }
        }
    </script>
    
    <script>
      $('#qty').on('focus', function() {
        //window.scrollTo(0,500);  
        //document.body.scrollTop = $(this).offset().top;
        if (navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/)) {           
            setTimeout(window.scrollTo(0,100),100); // first value for left offset, second value for top offset
        }else{
            $('html,body').animate({
                scrollTop: 100,
                scrollLeft: 0
            }, 800, function(){
                $('html,body').clearQueue();
            });
        }
      });  
    </script>
      
    <script>
    function validatorGS(){
      var code = "validatorGS";
      var stockCd = $('#ptNum').val();
      
      $.ajax({
        url:"https://script.google.com/macros/s/AKfycbxxRB4577AipPmQfMdJdR-9b85NeKJao7l868DgEtgouVPc9qMi/exec",data:
        {"code":code, "stockCd":stockCd}, 
        type:"GET",
        dataType:"json",
        }).done(function(res) {
          if (res==1){
            //alert(res);
          }else{
            alert(res);
          }
        })
          .fail(function(e) {
          alert("error:" + e)
        });
      }
    </script>
      
    <script>
    function validatorFS(){
      var code = "validatorFS";
      var stockCd = $('#stockCd').val();
      
      $.ajax({
        url:"https://script.google.com/macros/s/AKfycbxxRB4577AipPmQfMdJdR-9b85NeKJao7l868DgEtgouVPc9qMi/exec",data:
        {"code":code, "stockCd":stockCd}, 
        type:"GET",
        dataType:"json",
        }).done(function(res) {
          if (res==1){
            //alert(res);
          }else{
            alert(res);
          }
        })
          .fail(function(e) {
          alert("error:" + e)
        });
      }
    </script>
        
    <script>
     function postToAppsScript(){      
      var location =$('#location').val();
      var ptNum = $('#ptNum').val();
      var stockCd = $('#stockCd').val();
      var unitOfMeasure = $('input[name="unitOfMeasure"]:checked').val() + " " + result;
      var qty = $('#qty').val();
      var notes = $('#notes').val();
      
      $.ajax({
        url:"https://script.google.com/macros/s/AKfycbxxRB4577AipPmQfMdJdR-9b85NeKJao7l868DgEtgouVPc9qMi/exec",data:
        {"location":location,"ptNum":ptNum,"stockCd":stockCd,"qty":qty,"unitOfMeasure":unitOfMeasure,"notes":notes}, 
        type:"POST",dataType:"json",statusCode:
        {0:function(){
            alert("JSON sent");
            $('input[name="unitOfMeasure"]:checked').prop('checked',false);
            $('input[name="ptNum"], textarea').val('');
            $('input[name="stockCd"], textarea').val('');
            $('input[name="qty"], textarea').val('');
            $('input[name="notes"], textarea').val('');
          }
        }
      });
    }  
      
    //var $form = $('form#formA'),
    //url = 'https://script.google.com/macros/s/AKfycbxxRB4577AipPmQfMdJdR-9b85NeKJao7l868DgEtgouVPc9qMi/exec'
      //$('#submit-form').on('click', function(e) {
        //e.preventDefault();
        //var jqxhr = $.ajax({
          //url: url,
          //method: "POST",
          //dataType: "json",
          //data: $form.serializeObject()
        //}).success(
          //alert('it is done');
        //);
      //})
      
    function uncheckAll(){
        $('input[name="unitOfMeasure"]:checked').prop('checked',false);
        $('input[type="text"], textarea').val('');
    }
    </script>
      
    <script>
      //var inputFields = [
        //{
          //labelId: '#locationLB',
          //inputId: '#location'
        //},
        //{
          //labelId: '#ptNumLB',
          //inputId: '#ptNum'
        //},
        //{
          //labelId: '#stockCdLB',
          //inputId: '#stockCd'
        //},
        //{
          //labelId: '#unitOfMeasureLB',
          //inputId: '#unitOfMeasure'
        //},
        //{
          //labelId: '#notesLB',
          //inputId: '#notes'
        //}
      //];
  
      //for(var i = 0; i < inputFields.length; i++) {
          //console.log('inputFields[i].inputId = '+inputFields[i].inputId);
          //var element = document.querySelector(inputFields[i].inputId);
          //element.addEventListener('focus', getEventListener(inputFields[i].labelId), true);
          //element.addEventListener('blur', function() {
          //console.log('blurEvent');
          //window.location.hash = "";
      //}, true);
    //}
    //function getEventListener(urlHash) {
      //return function(e) {
        //console.log('focusEvent = '+urlHash);
        //window.location.hash = urlHash;
      //};
    //}
    </script>
