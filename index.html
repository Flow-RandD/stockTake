<!DOCTYPE html>
<html>
  <head>
  <link rel="manifest" href="manifest.json">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="application-name" content="calUP">
  <meta name="apple-mobile-web-app-title" content="sorUP">
  <meta name="theme-color" content="#b3ffff">
  <meta name="msapplication-navbutton-color" content="#ffff00">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="msapplication-starturl" content="https://flow-randd.github.io/calendarUpdate/">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    
    <style> 
      h5 {
        color: grey;
        margin-top: 0px
      }
      html, body {
        height: 90%;
        background: #FFFFFF;
        padding: 0px;
        height: 100%;
        width: 99%;
        margin: auto
        background: #FFFFFF; /* For browsers that do not support gradients */
        background: -webkit-linear-gradient(rgba(179,255,255,1), white);
        background: -moz-linear-gradient(rgba(179,255,255,1), white);
        background: -o-linear-gradient(rgba(179,255,255,1), white);
        background: linear-gradient(rgba(179,255,255,1), white 70%);
      }
      #div1 {  
        border-radius: 25px;
        padding: 10px;
        height: auto;
        width: auto;
        margin: auto
      }
      img {
        display: block;
        margin: auto;
        width: 80%
      }
    </style>
    <img src="https://flow-randd.github.io/calendarUpdate/images/Flowstore_Logo_CUT OUT_v1.png" alt="FLOWSTORE SYSTEMS LTD.">
  </head>

  <body>
  <bodyInner>  
  <header><marquee><h3>Stock Take</h3></marquee></header>
    <div id="div1">
    <h5>Please complete the form</h5>
    
    <form name="formA">
        Location:<br>
        <input type="text" id="location" name="location" style="width:50%"><br><br>
        GS-ACE Part Number:<br>
        <input type="text" id="ptNum" name="ptNum" style="width:50%"><br><br>
        Flowstore Stock Code:<br>
        <input type="text" id="stockCd" name="stockCd" style="width:50%"><br><br>
        Unit of Measure:<br>
        <input type="radio" id="unitOfMeasure" name="unitOfMeasure" value="metre">Metre<br>
        <input type="radio" id="unitOfMeasure" name="unitOfMeasure" value="each">Each<br><br>
        Notes:<br>
        <input type="text" id="notes" name="notes" style="width:50%"><br><br>
    </form>
      
    <div id="clickers">  
    <!-- Trigger/Open The Modal -->
    <button class="action" id="myBtn" onclick="postToGoogle()">Update</button>
    <!-- Clear -->
    <button class="Close" onclick="uncheckAll()">Clear</button><p><br><p>
      
    <!--Add buttons to initiate auth sequence and sign out-->
    <button id="authorize-button" style="display: none;">Authorise</button><p>
    <button id="signout-button" style="display: none;">Sign Out</button>
    </div>
      
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
      
    <script>
      var radios = document.formA.unitOfMeasure;
        for(var i = 0, max = radios.length; i < max; i++) {
          radios[i].onclick = function() {
            if (this.value=="metre"){
              result = prompt("How many metres is this item:","3");
            }else {
              result = "";
            }
          }
        }
    </script>
      
    <script>
    function postToGoogle(){      
      var location =$('#location').val();
      var ptNum = $('#ptNum').val();
      var stockCd = $('#stockCd').val();
      var unitOfMeasure = $('input[name="unitOfMeasure"]:checked').val() + " " + result;
      var notes = $('#notes').val();
      
      $.ajax({
        url:"https://docs.google.com/forms/d/e/1FAIpQLSfusBkjqEosrZc5SA-mzf1dVG0aNrD47A5DZk8gNKqYbbbfFA/formResponse",data:
        {"entry.1023543781":location,"entry.1737149180":ptNum,"entry.2135201187":stockCd,"entry.427889953":unitOfMeasure,"entry.1459547379":notes}, 
        type:"POST",dataType:"xml",statusCode:
        {0:function(){
            alert("Stock record updated");
            $('input[name="unitOfMeasure"]:checked').prop('checked',false);
            $('input[name="ptNum"], textarea').val('');
            $('input[name="stockCd"], textarea').val('');
            $('input[name="notes"], textarea').val('');
          }
        }
      });
    }
      
    function uncheckAll(){
        $('input[name="unitOfMeasure"]:checked').prop('checked',false);
        $('input[type="text"], textarea').val('');
    }
    </script>
      
    <script>
       var inputFields = [
        {
          labelId: '#name',
          inputId: '#nameInput'
        },
        {
          labelId: '#email',
          inputId: '#emailInput'
        },
        {
          labelId: '#homephone',
          inputId: '#homephoneInput'
        },
        {
          labelId: '#mobilephone',
          inputId: '#mobilephoneInput'
        },
        {
          labelId: '#address',
          inputId: '#addressInput'
        },
        {
          labelId: '#city',
          inputId: '#cityInput'
        },
        {
          labelId: '#province',
          inputId: '#provinceInput'
        },
        {
          labelId: '#postalcode',
          inputId: '#postalcodeInput'
        }
      ];
  
      for(var i = 0; i < inputFields.length; i++) {
          console.log('inputFields[i].inputId = '+inputFields[i].inputId);
          var element = document.querySelector(inputFields[i].inputId);
          element.addEventListener('focus', getEventListener(inputFields[i].labelId), true);
          element.addEventListener('blur', function() {
          console.log('blurEvent');
          window.location.hash = "";
      }, true);
    }

    function getEventListener(urlHash) {
      return function(e) {
        console.log('focusEvent = '+urlHash);
        window.location.hash = urlHash;
      };
    }
    </script>
